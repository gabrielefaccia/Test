
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Verifica ID Utente VTE</title>
</head>
<body>
  <h2>Verifica ID Utente</h2>
  <p>Inserisci il tuo username e access key per ottenere l'ID</p>
  <input type="text" id="username" placeholder="Username"><br>
  <input type="password" id="accessKey" placeholder="Access Key"><br><br>
  <button onclick="verifica()">Verifica ID</button>
  <pre id="output" style="margin-top:20px; background:#f0f0f0; padding:10px;"></pre>

  <script>
    function verifica() {
      const username = document.getElementById('username').value;
      const accessKey = document.getElementById('accessKey').value;
      const token = btoa(username + ':' + accessKey);

      fetch("https://crm.fefcentroautomazioni.it/restapi/v1/vtews/query", {
        method: "POST",
        headers: {
          "Authorization": "Basic " + token,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          query: `SELECT id FROM Users WHERE user_name="\${username}";`
        })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("output").textContent = JSON.stringify(data, null, 2);
      })
      .catch(err => {
        document.getElementById("output").textContent = "Errore: " + err;
      });
    }
  </script>
</body>
</html>
